\section{Threat Model} \label{sec:adversary}

We consider a strong attacker who is targeting all or a subset of users visiting
a particular website over Tor. It is generally difficult to perform a targeted
attack on a single particular Tor user because one needs to identify the user's
connection before performing the attack:
	something that Tor's anonymity properties frustrate.
However, it is not difficult to perform an attack on all or a subset of unknown
users of a particular service. A network vantage point to perform such an attack
is easily obtained by operating an exit relay (for a subset of Tor users) or by
compromising the network path of multiple exit relays or the final destination.
Once so positioned, the network traffic can be intercepted (with associated
forged certificate and SCTs). The subsequent attack on decrypted network traffic
may be passive (to gather user credentials or other information) or active.
Typical examples of active attacks are to change cryptocurrency addresses to
redirect funds to the attacks or to serve an exploit to the user's browser for
\emph{user deanomymization}. Without the ability to intercept traffic (i.e.,
forge certificates and SCTs without detection), all of these attacks become more
difficult.

All of the components of such an attack have been seen in-the-wild numerous
times. Untargeted attacks on visitors of a particular website include Syria's
interception of Facebook traffic using a self-signed 512-bit RSA key in ~2012,
Iran's interception of Bing and Google traffic using the Diginotar
CA~\cite{diginotar}, and the 2018 MyEtherWallet self-signed certificate that was
used as part of a BGP hijack~\cite{myetherwallet}.  The latter is also an
example of redirecting routing as part of an attack (either suspected or
confirmed) other examples of which are Iran hijacking 10 prefixes of Telegram
(an encrypted messaging application) in 2018, another attack on cryptocurrency
in 2014 this time targeting unencrypted mining
traffic~\cite{bgp-hijacking-for-crypto,bgp-hijacking-for-crypto-2}, and hijacks
that may have been intelligence-gathering (or honest mistakes) including two
hijacks by Russian ISPs 2017 and China in 2018 and 2019~\cite{wiki-bgp}.
Finally, there are several examples of law enforcement serving exploits to Tor
Browser users to de-anonymize and subsequently arrest
individuals~\cite{de-anonymize-exploit}.

With
the attacker's goal in mind, we consider someone that controls
	a CA,
	enough CT logs to pass TB's SCT-centric CT policy, 
	some Tor clients, and
	a fraction of Tor relays.
For example, it is possible to
	issues certificates and SCTs,
	dishonor promises of public logging,
	present split-views at will,
	intercept and delay traffic from controlled exit relays as well as CT logs,
		and
	be partially present in the network.
This includes a weaker attacker that does not \emph{control} CAs and CT logs,
but, who \emph{gained access} to the relevant signing keys~\cite{turktrust,%
gdca1-omission}.  A modest fraction of CTor entities can be subject to DoS, but
not everyone at once and all the time.  In other words, we consider the threat
model of Tor and TB as a starting point~\cite{tor,tor-browser}.  Any
attacker that can reliably disrupt CT and/or Tor to such a large extent is
therefore not within our threat model.
% TODO: not sure if we need to emph "it assumed that the attacker knows all Tor
% relay configurations, e.g., available memory and setup of torlog". now (?).

%
% Attacker goal and mindset
%
Given that we are in the business of enforcing CT, the attacker needs to hide
mis-issued TLS certificates and SCTs from entities that audit the CT landscape.
As described in Section~\ref{sec:background:ct}, this can either be achieved by
omission or split-view attacks.  Our intended attacker is clearly powerful and may
successfully issue a certificate chain and associated SCTs without detection
some of the time, but, a CA caught in mis-issuance or a CT log that violated an
MMD promise will no longer be regarded as trusted.  Therefore, we assume a
\emph{risk-averse} attacker that above a relatively low probability of detection
would be deterred from engaging in such activities.

%
% - Our goal: detect TB HTTPS MitM
% - Why: it is a reasonable prerequisite to conduct attacks against TB users
%
We want to minimize the existence of undetectable man-in-the-middle attacks
against TB.  The goal of \emph{detection} is inherited from CT's threat
model, which aims to remedy certificate mis-issuance \emph{after the fact}; not
prevent it~\cite{ct/a}.

%
% Defer introducing threats that follow from design details
%
We identify additional threats that follow from our threat model and design
in the security analysis.  Namely, attack vectors related to
	timing (Section~\ref{sec:analysis:pr:phase1}) as well as
	Tor relay tagging and flooding (Section~\ref{sec:auditor:analysis}).
