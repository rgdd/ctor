\section{Log Extension} \label{sec:log}
If we allow small---yet significant---changes to the CT landscape, it is
possible to avoid inclusion verification and the involved complexities as
described in Section~\ref{sec:auditor}.  The extension is based on returning
back to the premise of some CT logs being honest, but still extend the base
design (Section~\ref{sec:base}) to \emph{detect} misbehaving CT logs. The
extension is nearly identical to the base design: TB submits presented SFOs
probabilistically to randomly selected CTRs in phase 1, which store the
submitted SFOs in phase 2 before any auditing takes place in phase 3. Here,
\emph{auditing} refers to adding a \emph{full SFO} to an independent CT log; not
just the underlying certificate chain as in the base design.  This is the main
difference in the log extension. By also adding the SCTs to other CT logs, the
issuing CT logs can be held accountable.

The prerequisite for such an extension to work is that CT logs support an
additional API endpoint:
	\texttt{add-sfo}.
First we describe how this endpoint could be operated so that \emph{the only
change} is that certificate chains and SCTs are added.  Next, we explain how
some complexity could be moved into Tor but at the cost of bringing back the
threat of flooding (see Section~\ref{sec:auditor:analysis:phase2}).

\textbf{Approach~1.}
Recall from Section~\ref{sec:auditor:design:phase2} that there must not be any
early signals that allow misbehaving CT logs to reactively merge certificate
chains before any MMD promise is violated.  To ensure that this is the case, the
\texttt{add-sfo} endpoint could require that the added SFO will be merged first
after the MMD (of the issuing log) has elapsed, such that the log (should have)
produced a STH that captured the omission by then.  For example, the SCT that is
returned by the \texttt{add-sfo} endpoint could have a timestamp that is
future-dated by at least two MMDs, and then it is not considered for merging
until that timestamp is in the present. The appeal of \emph{delayed merges} is
that SFOs need not be stored any longer than what is necessary for privacy at
CTRs, completely avoiding the threat of network-wide flushes within our threat
model. If so, the analysis in Section~\ref{sec:base} applies without
modifications, except that misbehaving CAs \emph{and} CT logs are exposed.

\textbf{Approach~2.}  The other option is to make minimal changes to the CT
landscape by operating the \texttt{add-sfo} endpoint without any other
expectation than that it must allow SCTs in addition to a certificate chain. To
avoid early signals, CTRs should employ the same delay strategy as suggested for
CT logs above: wait at least two MMDs before adding a (newly issued) SFO. This
is essentially the same as an attacker that maximized the storage phase by
waiting until the last second to produce an STH as discussed in
Section~\ref{sec:auditor:analysis:phase2}, except that such behavior is assumed
rather than confirmed.  Clearly this brings flooding back to the table, and CTRs
need the extra-info metrics from Section~\ref{sec:auditor:extra-info} to allow
detection.
