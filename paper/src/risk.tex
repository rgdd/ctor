\section{Attacker Risk} \label{sec:risk}
We assume a risk-averse attacker: we want to make the \emph{probability} of
detection as well as the \emph{impact} of detection as high as possible.

\subsection{Impact of Being Detected} \label{sec:risk:impact}
Upon detection of a mitm attack, we consider four possible types of impact for
the attacker:
\begin{itemize}
    \item None, the attack was detected but how it was carried out remains
    unknown.
    \item Minor, the attack was detected and carried out by performing a
    network-wide attack (e.g., by flooding CTRs or a network-wide DoS). This is
    likely hard to attribute to the actual attacker but due to its network-wide
    effects draws a lot of unwanted attention.
   \item Significant, cryptographic evidence is public that proves that a
   certificate authority has misbehaved.
   \item Catastrophic, cryptographic evidence is public that proves that a CT
   log has misbehaved.
\end{itemize}

Obviously, we aim to to minimize the existance of successful attacks where it
cannot be established how the attack was carried out. Attacks with only minor
impact for an attacker are unavoiable due to Tor's threat model. The primary
goal of our design is to maximise the outcome with significant or catastrophic
impact.

% In general, the impact of the public detecting that some attack is ongoing may
% be modest. The key impact is when an inconsistent SFO is found, since it is
% signed. An inconsistent SFO indicates one of two things: either the issuing CA
% messed up, or it was the CT log. Since a log has a MMD of time since the SFO to
% act, it is likely a good idea to wait at least MMD before auditing. This will
% maximize the impact, since proving log misbehaviour is significantly more costly
% than for a CA. This is a strength of our proposal we need to lean on: it's
% devastatingly expensive for an attacker, especially if we want to make dragnet
% surveillance harder, not few targeted attacks.

\subsection{Probability of Being Detected} \label{sec:risk:probability}
Given our design and threat model, consider the case of an attacker that
attempts to MitM a single connectionOur goal here is to reason about the
probability of an attacker being detected. First, we can go back to our threat
model: an attacker can perform am undetected MitM by either \emph{inconsistency}
or \emph{omission}. As we argue later in Section~\ref{sec:security}, we consider
in the case of inconsistency that a probability of detection of $1.0$ is
reasonable. Therefore, we focus next on what we can say about the probability of
undetectable omission.

Omission for an attacker that attempts to MitM a single connection by creating
an inconsistent SFO can occur at any of the following four phases of our design:
\begin{enumerate}
    \item As soon as the SFO is received at Tor Browser until it has been sent
    to a CTR.
    \item At the CTR before auditing (see Section~\ref{sec:design:api}).
    \item At the CTR while auditing (see Section~\ref{sec:design:ctr:audit}).
    \item At the CTR after auditing but before reaching the auditor (see
    Section~\ref{sec:design:ctr:audit}).
\end{enumerate}

We assume that auditors are trusted, so once the SFO arrives at an auditor the
attack been detected. 

The above four phases form a weakest link scenario: if any of them fails, the
attack is not detected. In terms of probability, the probability of being
detected cannot be higher than \texttt{ct-submit-pr}; the probability that TB
submits a SFO to a CTR. Our design attempts to make \texttt{ct-submit-pr} be the
dominant factor in the probability of detection for phase 1. For phase 2, an
important consideration is the assumption about the fraction of CTRs in control
of the attacker. Phase 3 and 4 are more complicated to reason about. Clearly, a
risk awerse attacker will look for reliable ways to prevent detection in any of
these phases. This analysis is the focus of our security analysis.