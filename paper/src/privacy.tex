\section{Privacy} \label{sec:privacy}
There is an inherent privacy problem in the setting due to how CT is designed
and deployed. A browser, like TB, that wishes to validate that SFOs presented to
it are \emph{consistent} and \emph{included} in CT logs must directly or
indirectly interact with CT logs wrt. its observed SFOs. Without protections
like Private Information Retrieval~\cite{PIR} that require server-side support
or introduction of additional parties and trust
assumptions~\cite{lueks-and-goldberg,kales}, exposing SFOs to any party risks
leaking (partial) information about the browsing activities of the user.

Given the constraints of the existing CT ecosystem, CTor is made
privacy-preserving thanks to the distributed nature of Tor with its anonymity
properties and high-uptime relays that make up the Tor network. First, all
communication between TB, CTRs, CT logs, and auditors are made over full
Tor-circuits. This is a significant privacy-gain, not available, e.g., to
browsers like Chrome that in their communications would reveal their public
IPv4-address (among a number of other potentially identifying metadata).
Secondly, the use of CTRs as intermediaries probabilistically delays the
interaction with the CT logs---making correlating TB user browsing with CT log
interaction harder for attackers---and safely maintains a dynamic cache of the
most commonly already verified SFOs\footnote{Note that the long-tail nature of
website popularity---over the Tor network as well as the regular
web~\cite{mani}---means that even a relatively small cache of the most
frequently observed SFOs will lead to a significant reduction of queries to the
CT logs.}. {\bf \color{red} Paul doesn't understand this footnote. Wouldn't a short-tail distribution mean that the cache is more effective?}\\
While regular browsers like Chrome could maintain a cache, TB's
security and privacy goals (see Section~\ref{sec:background:tor}) 
prohibit such shared (persisted) dynamic state.

CTRs are also essential for security in the setting of the auditor extension. A
rational attacker will produce SFOs with SCT timestamps that are too new to have
to be part of CT logs at the time of the attack. TB cannot store SFOs for any
extended time period without violating its security and privacy goals, not to
mention that presumably most TB sessions are not maintained for
days (as required, see analysis in Section~\ref{sec:auditor:analysis}) 
{\bf \color{red} What analysis is this pointing at?}\\
but rather minutes~\cite{DBLP:conf/pam/AmannS16}. Further, buffering
at TB is not an option, since an attacker could compromise TB shortly
after presenting the forged SFO.

The main limitation of CTor in terms of privacy is that CTor continuously leaks
to CT logs---and to a \emph{lesser extent} auditors in one of our extensions due
to break-and-backoff behavior if the logs are unresponsive---a fraction of
certificates of websites visited using TB to those that operate CT logs.
This provides
to a CT log a partial list of websites visited via the Tor network over a period
of time (determined by \texttt{ct-delay-dist}), together with some indication of
distribution based on the number of active CTRs. It does not, however, provide
even pseudonymously any information about which sites individual users visit,
much less with which patterns or timing. As such it leaks significantly less
information than does OCSP validation by TB or DNS resolution at
exit-relays~\cite{TorDNS}, both of which indicate visit activity in real time to
a comparably small number of entities.

Another significant privacy limitation is that relays with the CTR flag learn
real-time browser behavior of Tor users. Relays without the Exit flag primarily
only transport encrypted Tor-traffic between clients and other relays, never to
destinations. If such relays are given the CTR flag---as we stated in the base
design, see Section~\ref{sec:base:consensus:ctr-flag}---then this might
discourage some from running Tor relays unless it is possible to opt out.
Another option is to give the CTR flag only to exit relays, but this \emph{might
be} undesirable for overall network performance despite the modest overhead of
CTor (Section~\ref{sec:performance}). Depending on the health of the network
and the exact incremental deployment of CTor, there are different trade-offs.
For example, fewer CTRs with higher bandwidth and less memory combined make it
easier to perform flooding attacks that flush the entire network.
